!function t(o,e,n){function i(s,r){if(!e[s]){if(!o[s]){var a="function"==typeof require&&require;if(!r&&a)return a(s,!0);if(l)return l(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=e[s]={exports:{}};o[s][0].call(f.exports,function(t){var e=o[s][1][t];return i(e?e:t)},f,f.exports,t,o,e,n)}return e[s].exports}for(var l="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,o,e){(function(n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n.React||t("react"),l=function(t,o){var e,n,i;for(null==o&&(o=1),o=Math.pow(10,o),e=["k","m","b","t"],n=e.length-1;n>=0;){if(i=Math.pow(10,3*(n+1)),t>=i){t=Math.round(t*o/i)/o,1e3===t&&n<e.length-1&&(t=1,n++),t+=e[n];break}n--}return t},s=i.createClass({displayName:"DailymotionFollow",getInitialState:function(){return{authenticated:null,isFollowing:null,hover:!1,fans_total:null}},componentDidMount:function(){var t=this;"undefined"==typeof DM&&console.error("Error: You must import Dailymotion javascript SDK."),this.isLogged().then(function(o){o&&t.onLogged(),t.setState({authenticated:o})})},componentDidUpdate:function(t,o){t.xid!==this.props.xid&&this.onLogged()},call:function(t,o){var e=void 0===arguments[2]?{}:arguments[2];return new Promise(function(n,i){DM.api(o,t,e,function(t){t.error?i(t.error):n(t)},!0)})},isLogged:function(t){return new Promise(function(t,o){DM.getLoginStatus(function(o){t(o.session?!0:!1)})})},onLogged:function(){var t=this;this.fetchCount(),this.isFollowing().then(function(o){t.setState({authenticated:!0,isFollowing:o})})},isFollowing:function(){var t="/me/following/"+this.props.xid;return this.call("get",t).then(function(t){return t.list.length?!0:!1})},fetchCount:function(){var t=this,o="/user/"+this.props.xid,e={fields:["fans_total"]};return this.call("get",o,e).then(function(o){var e=o.fans_total;return t.setState({fans_total:e}),e})},follow:function(){var t=this;this.setState({isFollowing:!0,hover:!1,fans_total:this.state.fans_total+1});var o="/me/following/"+this.props.xid;return this.call("post",o).then(function(t){return t})["catch"](function(o){return console.error("Error while follow"),t.setState({isFollowing:!1}),o})},unfollow:function(){var t=this;this.setState({isFollowing:!1,fans_total:this.state.fans_total-1});var o="/me/following/"+this.props.xid;return this.call("delete",o).then(function(t){return t})["catch"](function(o){return console.error("Error while follow"),t.setState({isFollowing:!0}),o})},onMouseEnter:function(){this.setState({hover:!0})},onMouseOut:function(){this.setState({hover:!1})},render:function(){var t="Follow",o=null,e="dm-follow ";switch(this.state.authenticated){case!0:this.state.isFollowing?(e+="dm-follow--unfollow ",o=this.unfollow,t=this.state.hover?"Unfollow ":"Following"):(e+="dm-follow--follow ",o=this.follow);break;case!1:e+="dm-follow--follow ",o=this.props.onLogin.bind(null,this.onLogged)}(null===this.state.authenticated||this.state.authenticated&&null===this.state.isFollowing)&&(e+="hidden "),this.state.hover&&(e+="active ");var n=void 0;return null!==this.state.fans_total&&0!==this.state.fans_total&&(n="active"),i.createElement("div",{className:e},i.createElement("button",{className:"btn dm-follow__btn",onClick:o,onMouseEnter:this.onMouseEnter,onMouseOut:this.onMouseOut},t),i.createElement("p",{className:"dm-follow__count "+n},l(this.state.fans_total,2)))}});n.DailymotionFollow=s,e["default"]=s,o.exports=e["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{react:void 0}]},{},[1]);