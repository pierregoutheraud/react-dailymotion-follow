!function t(o,n,e){function i(s,r){if(!n[s]){if(!o[s]){var a="function"==typeof require&&require;if(!r&&a)return a(s,!0);if(l)return l(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[s]={exports:{}};o[s][0].call(f.exports,function(t){var n=o[s][1][t];return i(n?n:t)},f,f.exports,t,o,n,e)}return n[s].exports}for(var l="function"==typeof require&&require,s=0;s<e.length;s++)i(e[s]);return i}({1:[function(t,o,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e.React||t("react"),l=function(t,o){var n,e,i;for(null==o&&(o=1),o=Math.pow(10,o),n=["k","m","b","t"],e=n.length-1;e>=0;){if(i=Math.pow(10,3*(e+1)),t>=i){t=Math.round(t*o/i)/o,1e3===t&&e<n.length-1&&(t=1,e++),t+=n[e];break}e--}return t},s=i.createClass({displayName:"DailymotionFollow",getInitialState:function(){return{authenticated:null,isFollowing:null,hover:!1,fans_total:null}},componentDidMount:function(){var t=this;"undefined"==typeof DM&&console.error("Error: You must import Dailymotion javascript SDK."),this.isLogged().then(function(o){o&&t.onLogged(),t.setState({authenticated:o})})},componentDidUpdate:function(t,o){t.xid!==this.props.xid&&this.onLogged()},call:function(t,o){var n=void 0===arguments[2]?{}:arguments[2];return new Promise(function(e,i){DM.api(o,t,n,function(t){t.error?i(t.error):e(t)},!0)})},isLogged:function(t){return new Promise(function(t,o){DM.getLoginStatus(function(o){t(o.session?!0:!1)})})},onLogged:function(){var t=this;this.fetchCount(),this.isFollowing().then(function(o){t.setState({authenticated:!0,isFollowing:o})})},isFollowing:function(){var t="/me/following/"+this.props.xid;return this.call("get",t).then(function(t){return t.list.length?!0:!1})},fetchCount:function(){var t=this,o="/user/"+this.props.xid,n={fields:["fans_total"]};return this.call("get",o,n).then(function(o){var n=o.fans_total;return t.setState({fans_total:n}),n})},follow:function(){var t=this;this.setState({isFollowing:!0,hover:!1,fans_total:this.state.fans_total+1});var o="/me/following/"+this.props.xid;return this.call("post",o).then(function(t){return t})["catch"](function(o){return console.error("Error while follow"),t.setState({isFollowing:!1,fans_total:t.state.fans_total+1}),o})},unfollow:function(){var t=this;this.setState({isFollowing:!1,fans_total:this.state.fans_total-1});var o="/me/following/"+this.props.xid;return this.call("delete",o).then(function(t){return t})["catch"](function(o){return console.error("Error while follow"),t.setState({isFollowing:!0,fans_total:t.state.fans_total+1}),o})},onMouseEnter:function(){this.setState({hover:!0})},onMouseOut:function(){this.setState({hover:!1})},onClick:function(){this.state.authenticated?this.state.isFollowing?this.unfollow():this.follow():this.props.onLogin(this.onLogged)},render:function(){var t="Follow",o="dm-follow ";switch(this.state.authenticated){case!0:this.state.isFollowing?(o+="dm-follow--unfollow ",t=this.state.hover?"Unfollow ":"Following"):o+="dm-follow--follow ";break;case!1:o+="dm-follow--follow "}(null===this.state.authenticated||this.state.authenticated&&null===this.state.isFollowing)&&(o+="hidden "),this.state.hover&&(o+="active ");var n=void 0;return null!==this.state.fans_total&&0!==this.state.fans_total&&(n="active"),i.createElement("div",{className:o},i.createElement("button",{className:"btn dm-follow__btn",onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseOut:this.onMouseOut},t),i.createElement("p",{className:"dm-follow__count "+n},l(this.state.fans_total,2)))}});e.DailymotionFollow=s,n["default"]=s,o.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{react:void 0}]},{},[1]);